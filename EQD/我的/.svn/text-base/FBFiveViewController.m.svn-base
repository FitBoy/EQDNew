//
//  FBFiveViewController.m
//  EQD
//
//  Created by 梁新帅 on 2017/3/18.
//  Copyright © 2017年 FitBoy. All rights reserved.
//

#import "FBFiveViewController.h"
#import "MyFirstTableViewCell.h"
#import "WebRequest.h"
#import "FBMyErWeiMaViewController.h"
#import "MyDangAn1ViewController.h"
#import "MGongSiViewController.h"
#import "MMyViewController.h"
#import "TFAQViewController.h"
#import "FXiTongViewController.h"
#import <UIImageView+AFNetworking.h>

#import "FRenWuViewController.h"
#import "FBeiWangLuViewController.h"
#import "FBMyPiZhunViewController.h"

#import "FShenQingViewController.h"
#import "FXiaoXiTongZhiViewController.h"
@interface FBFiveViewController ()<UITableViewDelegate,UITableViewDataSource>
{
    UITableView *tableV;
    UserModel *user;
    NSMutableArray *arr_info;
    NSMutableArray *arr_one;
    NSMutableArray *arr_two;
    NSMutableArray *arr_big;
    NSMutableArray *arr_three;
    NSMutableArray *arr_four;
    NSMutableArray *arr_five;
}


@end

@implementation FBFiveViewController

- (void)viewDidLoad {
    [super viewDidLoad];
     self.navigationItem.title=@"我的";
    user =[WebRequest GetUserInfo];
    UIBarButtonItem *right =[[UIBarButtonItem alloc]initWithImage:[[UIImage imageNamed:@"add_eqd2"]  imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal] style:UIBarButtonItemStylePlain target:self action:@selector(kuaijiefangshi)];
    [self.navigationItem setRightBarButtonItem:right];
    self.automaticallyAdjustsScrollViewInsets=NO;
    
    tableV = [[UITableView alloc]initWithFrame:CGRectMake(0, 64, DEVICE_WIDTH, DEVICE_HEIGHT-50-64) style:UITableViewStyleGrouped];
    tableV.delegate=self;
    tableV.dataSource=self;
    [self.view addSubview:tableV];
    tableV.rowHeight=50;
    arr_info = [NSMutableArray arrayWithArray:@[@"个人档案"]];
    
    arr_one = [NSMutableArray arrayWithArray:@[@[@"shenq.png",@"我的申请"],@[@"pizhun.png",@"我的批准"],@[@"renwu.png",@"我的任务"]]];
    arr_two=[NSMutableArray arrayWithArray:@[@[@"dak.png",@"我的打卡"],@[@"kanb.png",@"我的看板"],@[@"",@"我的备忘录"],@[@"xitong.png",@"消息通知"]]];
    
    arr_three=[NSMutableArray arrayWithArray:@[@[@"gere",@"我"],@[@"qiye.png",@"我的企业"]]];
    arr_four=[NSMutableArray arrayWithArray:@[@[@"shezh",@"系统设置"]]];
//    arr_five = [NSMutableArray arrayWithArray:@[]];
    arr_big =[NSMutableArray arrayWithCapacity:0];
    [arr_big addObject:arr_info];
    [arr_big addObject:arr_one];
    [arr_big addObject:arr_two];
    [arr_big addObject:arr_three];
    [arr_big addObject:arr_four];
//    [arr_big addObject:arr_five];

    
}


#pragma  mark - 表的数据源
-(CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
{
    return 6;
}
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.section==0) {
        return 60;
    }
    return 50;
}
-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return arr_big.count;
}
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSArray *arr =arr_big[section];
    return arr.count;
}

-(void)erWeimaclick{
    NSLog(@"二维码");
    FBMyErWeiMaViewController  *EWMvc =[[FBMyErWeiMaViewController alloc]init];
    EWMvc.hidesBottomBarWhenPushed=YES;
    [self .navigationController pushViewController:EWMvc animated:NO];
    
}
-(void)headClick
{
    //个人名片
}
-(UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    NSArray *arr =arr_big[indexPath.section];
    static NSString *cellId=@"cellID";
    static NSString *cellId1=@"cellID1";
    if (indexPath.section==0) {
        MyFirstTableViewCell *cell1 =[tableView dequeueReusableCellWithIdentifier:cellId];
        if (!cell1) {
            cell1 =[[MyFirstTableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId];
            cell1.accessoryType=UITableViewCellAccessoryDisclosureIndicator;
        }
        
        [cell1.IV_headimg setImageWithURL:[NSURL URLWithString:user.iphoto] placeholderImage:[UIImage imageNamed:@"no_login_head.png"]];
        
        [cell1.B_erWeima addTarget:self action:@selector(erWeimaclick) forControlEvents:UIControlEventTouchUpInside];
        UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(headClick)];
        [cell1.IV_headimg addGestureRecognizer:tap];
        cell1.L_name.text = user.pname;
        cell1.L_zhanghao.text = [NSString stringWithFormat:@"易企点号：尚未开通"];
        
        return cell1;
    }
    
    else{
        UITableViewCell *cell =[tableView dequeueReusableCellWithIdentifier:cellId1];
        if (!cell) {
            cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId1];
            cell.accessoryType=UITableViewCellAccessoryDisclosureIndicator;
        }
        NSArray *arr1 =arr[indexPath.row];
        
        cell.imageView.image = [UIImage imageNamed:arr1[0]];
        cell.textLabel.text =arr1[1];
        return cell;
    }
}

#pragma  mark - 表的协议代理
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (indexPath.section==0) {
        if (indexPath.row==0) {
           //修改个人档案详情
            
            [WebRequest Com_AddStaffWithuid:[USERDEFAULTS objectForKey:Y_Zhanghao] And:^(NSDictionary *dic) {
                if ([dic[Y_STATUS] integerValue]==200) {
                    NSArray *arr =dic[Y_ITEMS];
                    if (arr.count) {
                        MyDangAn1ViewController *DAvc1 =[[MyDangAn1ViewController alloc]init];
                        DAvc1.hidesBottomBarWhenPushed=YES;
                        [self.navigationController pushViewController:DAvc1 animated:NO];
                    }
                }
                else
                {
                    MBProgressHUD *hud=[MBProgressHUD showHUDAddedTo:self.view  animated:YES];
                    hud.mode = MBProgressHUDModeText;
                    hud.label.text =@"实名认证后才可查看个人档案";
                    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC);
                    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
                        [MBProgressHUD hideHUDForView:self.view  animated:YES];
                    });
                }
            }];
            
            
            
            
        }
    }
    
    
    
    
    if (indexPath.section==1) {
        switch (indexPath.row) {
            case 0:
            {
                NSLog(@"我的申请");
                FShenQingViewController *SQvc =[[FShenQingViewController alloc]init];
                SQvc.hidesBottomBarWhenPushed=YES;
                [self.navigationController pushViewController:SQvc animated:NO];
                
                
            }
                break;
            case 1:
            {
                NSLog(@"我的批准");
                FBMyPiZhunViewController  *PZvc =[[FBMyPiZhunViewController alloc]init];
                PZvc.hidesBottomBarWhenPushed =YES;
                [self.navigationController pushViewController:PZvc animated:NO];
                
            }
                break;
                
            case 2:
            {
                NSLog(@"我的任务");
                FRenWuViewController *EWvc =[[FRenWuViewController alloc]init];
                EWvc.hidesBottomBarWhenPushed =YES;
                [self.navigationController pushViewController:EWvc animated:NO];
                
            }
                break;
            default:
                break;
        }
    }
    
    if (indexPath.section==2) {
        switch (indexPath.row) {
            case 0:
            {
                NSLog(@"我的打卡");
                
            }
                break;
                
            case 1:
            {
                NSLog(@"我的看板");
                
            }
                break;
            case 2:
            {
               //我的备忘录
                FBeiWangLuViewController *BWLvc =[[FBeiWangLuViewController alloc]init];
                BWLvc.hidesBottomBarWhenPushed=YES;
                [self.navigationController pushViewController:BWLvc animated:NO];
                
                
            }
                break;
            case 3:
            {
                //消息通知
                FXiaoXiTongZhiViewController *XXTZvc =[[FXiaoXiTongZhiViewController alloc]init];
                XXTZvc.hidesBottomBarWhenPushed =YES;
                [self.navigationController pushViewController:XXTZvc animated:NO];
                
            }
                break;
            default:
                break;
        }
    }
    
    if (indexPath.section==3) {
        switch (indexPath.row) {
            case 0:
            {
                //我
                MMyViewController *Myvc =[[MMyViewController alloc]init];
                Myvc.hidesBottomBarWhenPushed =YES;
                [self.navigationController pushViewController:Myvc animated:NO];
            }
                break;
            case 1:
            {
                //我的企业
                MGongSiViewController *GSvc =[[MGongSiViewController alloc]init];
                GSvc.hidesBottomBarWhenPushed = YES;
                [self.navigationController pushViewController:GSvc animated:NO];
                
            }
                break;
            default:
                break;
        }
       
    }
    
    if (indexPath.section==4) {
        //系统设置
        FXiTongViewController *XTvc =[[FXiTongViewController alloc]init];
        XTvc.hidesBottomBarWhenPushed =YES;
        [self.navigationController pushViewController:XTvc animated:NO];
       
        
    }
    if (indexPath.section ==5) {
       
        
    }
    
    
}


@end
